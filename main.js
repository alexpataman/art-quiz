(()=>{var t,e={142:()=>{console.log("%cArt Quiz","font-weight: bold; font-size: 18px"),console.log("https://github.com/rolling-scopes-school/tasks/blob/master/tasks/art-quiz/art-quiz.md\n\n"),console.log("%cСамооценка:","font-weight: bold;"),console.log('\nВыполнены все пункты задания.\n✔️ Стартовая страница и навигация +20\nПояснения:\n=> иконка "<" в хедере возвращает на предыдущую страницу;\n=> лого в хедере всегда возвращает на стартовую страницу;\n=> на карточке сыгранной категории ссылка на результаты раунда появляется по клику (появляется ховер с вариантами "играть еще" и "статистика"). Также на результаты ведет клик по цифре количества ответов (справа от названия категории).\n✔️ Настройки +40\nПояснения:\n=> Настройки сохраняются автоматически при изменении.\n✔️ Страница категорий +30\n✔️ Страница с вопросами +50\n✔️ Страница с результатами +50\nПояснения:\n=> Результат повторного прохождения раунда фиксируется после прохождения раунда (категории). До его завершения - продолжает отображаться предыдущий сохраненный результат.\n✔️ Одновременная загрузка и плавная смена изображений +10\n✔️ Анимация +20\nПримеры анимации:\n=> Плавные переходы между состяниями приложения (смена контента)\n=> Анимация появления модального окна\n=> Анимация лоадера загрузки контента (можно явно увидеть в квизе по картинам)\n=> Анимация появления блока настроек\n=> Анимация таймера\n=> Анимация иконки настроек\n✔️ Дополнительный функционал на выбор +14\n=> фоновая музыка и отдельный пункт в настройках (вкл/выкл и громкость) для неё [+2]\n=> разные уведомления по окончанию раунда в зависимости от результата [+2]\n=> перевод приложения на два языка [+5]\n=> возможность скачать картину на компьютер (ссылка на скачивание отображается в модальном окне с подробной информацией о картине) [+5]\n=> возможность выполнить сброс данных и начать прохождение раундов заново (кнопка в настройках) [+?]\n'),console.log("%cИтого: 234/220 => 220","font-weight: bold")},393:(t,e,s)=>{"use strict";const a=!1,i="alexpArtQuiz_";class n{constructor(){this.prefix=i}computeFieldName(t){return this.prefix+t}set(t,e){localStorage.setItem(this.computeFieldName(t),JSON.stringify(e))}get(t){return this.exists(t)?JSON.parse(localStorage.getItem(this.computeFieldName(t))):null}exists(t){return!!localStorage.getItem(this.computeFieldName(t))}clear(){Object.keys(localStorage).forEach((t=>{0===t.indexOf(this.prefix)&&localStorage.removeItem(t)}))}}class o{constructor(t){this.isOpen=!1,this.modalContainer=t,this.modalContent=this.modalContainer.querySelector(".modal-content"),this.overlayElement=o.createOverlayElement(),document.body.append(this.overlayElement)}open(t=""){document.body.classList.add("modal-open"),this.modalContent.replaceChildren(t),this.modalContainer.classList.add("open"),this.showOverlay(),this.isOpen=!0,o.fixBody()}close(){document.body.classList.remove("modal-open"),this.modalContainer.classList.remove("open"),this.removeOverlay(),this.isOpen=!1,o.unfixBody()}static createOverlayElement(){const t=document.createElement("div");return t.className="modal-overlay",t}showOverlay(){this.overlayElement.classList.add("visible")}removeOverlay(){this.overlayElement.classList.remove("visible")}static fixBody(){document.body.style.top=`-${window.scrollY}px`,document.body.style.position="fixed"}static unfixBody(){document.body.style.position="",document.body.style.top=""}}class r{constructor(){this.TRANSITION_TIMEOUT=500,this.loadingItems=[],this.state=null,this.setSelectors(),this.initModal()}initModal(){this.modal=new o(document.getElementById("modal"))}setState(t){this.state=t}startLoader(){this.main.classList.add("loading")}finishLoader(){this.main.classList.remove("loading")}addLoadingItem(t){this.loadingItems.push(t)}removeLoadingItem(t){this.loadingItems=this.loadingItems.filter((e=>e===t)),0===this.loadingItems.length&&setTimeout((()=>this.finishLoader()),1e3)}setSelectors(){this.body=document.querySelector("body"),this.header=document.querySelector("body > header"),this.main=document.querySelector("body > main"),this.footer=document.querySelector("body > footer"),this.backLinkWrapper=this.header.querySelector(".back-link-wrapper")}setPageContent(t,e){return new Promise((s=>{this.main.style.opacity=0,setTimeout((()=>{this.setState(e),this.setBodyClassName(e),this.main.replaceChildren(t),this.main.style.opacity=1,document.dispatchEvent(new CustomEvent(`${e}Ready`)),s(!0)}),this.TRANSITION_TIMEOUT)}))}setBodyClassName(t){this.body.className=t}addBackLink(t,e){setTimeout((()=>{this.backLink=r.getBackLink(),this.backLinkWrapper.replaceChildren(this.backLink),this.backLink.addEventListener("click",(()=>{this.backLink.remove(),t.apply(e)}),{once:!0})}),this.TRANSITION_TIMEOUT)}static getBackLink(){const t=document.createElement("a");return t.className="arrow-left back",t}static fixBody(){document.body.style.top=`-${window.scrollY}px`,document.body.style.position="fixed"}static unfixBody(){document.body.style.position="",document.body.style.top=""}}class l{static DEFAULT_VALUES={defaultEffectsVolume:50,defaultMusicVolume:30};static effectsFiles={answerCorrect:"./assets/sounds/answer_correct.mp3",answerWrong:"./assets/sounds/answer_wrong.mp3",roundEnd:"./assets/sounds/round_end.mp3"};static musicFiles={music:"https://raw.githubusercontent.com/alexpataman/art-quiz-data/main/sounds/music/main.mp3"};constructor(){this.instances={effects:{},music:{}},this.preload("effects",l.effectsFiles),this.preload("music",l.musicFiles)}getDefaultValue(t){return l.DEFAULT_VALUES[t]}preload(t,e){Object.keys(e).forEach((s=>{const a=new Audio;a.src=e[s],this.instances[t][s]=a}))}setVolume(t,e){const s=e/100;Object.values(this.instances[t]).forEach((t=>{t.volume=s}))}playEffect(t){this.instances.effects[t].play()}playMusic(t="music"){this.instances.music[t].play(),this.instances.music[t].loop=!0}stopMusic(t="music"){this.instances.music[t].pause()}}var c=s(727),u=s(102),d=s.n(u);class h{RESOURCES={ru:{translation:{Settings:"Настройки",Language:"Язык","Artist Quiz":"Художники","Pictures Quiz":"Картины","Sound Effects":"Звуковые эффекты",On:"Вкл",Off:"Выкл",Music:"Музыка","Time Game":"Игра на время","Clear All Data":"Очистка всех данных приложения","Volume of sound effects":"Громкость звуковых эффектов","Volume of music":"Громкость музыки","Time to answer":"Время на ответ","All data and game progress will be reset":"Все данные и игровой прогресс будут сброшены",Clear:"Очистить",Default:"Сбросить",Close:"Закрыть","Which picture was painted by {{author}}?":"Какую картину нарисовал {{author}}?","Play Again":"Ещё раз",Score:"Результаты",Next:"Продолжить","Good luck next time!":"Удачи в следующий раз!","Congratulations!":"Неплохо!","Grand result":"Отлично",Home:"Главная","Next Quiz":"Далее",Download:"Скачать"}}};selectorAttr="data-i18n";init(t){c.Z.init({lng:t,debug:!1,fallbackLng:!1,returnEmptyString:!1,resources:this.RESOURCES}),this.localize=d().init(c.Z,{selectorAttr:this.selectorAttr,parseDefaultValueFromContent:!1}),this.applySettings(),document.addEventListener("updateSettings",(()=>this.applySettings()))}applySettings(t){c.Z.changeLanguage(t),this.localize("*")}}class m{constructor(t){this.app=t,this.DEFAULT_VALUES={enableSoundEffects:!0,effectsVolumeLevel:this.app.sounds.getDefaultValue("defaultEffectsVolume"),enableMusic:!1,musicVolumeLevel:this.app.sounds.getDefaultValue("defaultMusicVolume"),timeLimit:"15",timeLimitedGame:!0,language:"ru"},this.data=this.getSettings()}init(){this.app.translations.init(this.data.language),this.setSelectors(),this.setHandlers(),this.adjustDependentSections()}adjustDependentSections(){this.form.querySelectorAll(".dependent").forEach((t=>{this.data[t.dataset.dependentOn]?t.classList.add("visible"):t.classList.remove("visible")}))}setSelectors(){this.htmlContainer=document.querySelector(".settings"),this.htmlContent=this.htmlContainer.querySelector(".content"),this.htmlToggleLink=document.querySelector(".settings-icon"),this.htmlCloseLink=this.htmlContainer.querySelector(".close"),this.htmlButtonClose=this.htmlContainer.querySelector(".save"),this.htmlButtonReset=this.htmlContainer.querySelector(".reset"),this.htmlButtonClearStorage=this.htmlContainer.querySelector(".clear-storage"),this.form=this.htmlContainer.querySelector("form")}toggleSettings(){this.htmlContent.classList.toggle("active"),this.fixBodyHandler()}fixBodyHandler(){this.htmlContent.classList.contains("active")?r.fixBody():r.unfixBody()}resetSettings(){this.setFormData(this.DEFAULT_VALUES)}handleFormChange(t){this.data=Object.fromEntries(new FormData(this.form).entries());const e=t.target.name;"language"===e&&(this.app.translations.applySettings(t.target.value),document.dispatchEvent(new Event("changeLanguage"))),"timeLimitedGame"===e&&document.dispatchEvent(new Event("changeTimeLimitedGameSetting")),"enableMusic"===e&&(t.target.checked?t.isTrusted&&this.app.sounds.playMusic():this.app.sounds.stopMusic()),"effectsVolumeLevel"===e&&(this.app.sounds.setVolume("effects",t.target.value),t.isTrusted&&this.app.sounds.playEffect("answerCorrect")),"musicVolumeLevel"===e&&this.app.sounds.setVolume("music",t.target.value),this.saveSettings(),this.adjustDependentSections()}saveSettings(){this.app.storage.set("settings",this.data),document.dispatchEvent(new Event("updateSettings"))}getSettings(){return this.app.storage.exists("settings")?this.app.storage.get("settings"):this.DEFAULT_VALUES}clearStorage(){this.app.storage.clear(),setTimeout((()=>{window.location.reload()}))}setFormData(t){const e=this.form.querySelectorAll("input"),s=[];e.forEach(((a,i)=>{switch(a.type){case"checkbox":!!t[a.name]!=!!a.checked&&(e[i].checked=!!t[a.name]==!!a.value,s.push(a));break;case"radio":e[i].checked||t[a.name]!==a.value||(e[i].checked=!0,s.push(a));break;default:e[i].value!==t[a.name]&&(e[i].value=t[a.name],s.push(a))}})),s.forEach((t=>{t.dispatchEvent(new Event("change",{bubbles:!0}))}))}setHandlers(){this.htmlToggleLink.addEventListener("click",(()=>this.toggleSettings())),this.htmlCloseLink.addEventListener("click",(()=>this.toggleSettings())),this.htmlButtonClose.addEventListener("click",(()=>this.toggleSettings())),this.htmlButtonClearStorage.addEventListener("click",(()=>this.clearStorage())),this.form.addEventListener("change",(t=>this.handleFormChange(t))),document.addEventListener("DOMContentLoaded",(()=>this.setFormData(this.data))),this.htmlButtonReset.addEventListener("click",(()=>{this.resetSettings()}))}}async function g(t,e){const s=document.createElement("a");s.href=await async function(t){const e=await fetch(t),s=await e.blob();return URL.createObjectURL(s)}(t),s.download=e+t.slice(t.lastIndexOf(".")),document.body.appendChild(s),s.click(),document.body.removeChild(s)}class p{constructor(t){this.quiz=t,document.addEventListener("changeTimeLimitedGameSetting",(()=>this.verifySettings()))}init(){this.quiz.settings.data.timeLimitedGame&&"question"===this.quiz.app.layout.state&&(this.settings={FULL_DASH_ARRAY:283,TIME_LIMIT:this.quiz.settings.data.timeLimit,WARNING_THRESHOLD:.6*this.quiz.settings.data.timeLimit,ALERT_THRESHOLD:.3*this.quiz.settings.data.timeLimit},this.COLOR_CODES={info:{color:"green"},warning:{color:"orange",threshold:this.settings.WARNING_THRESHOLD},alert:{color:"red",threshold:this.settings.ALERT_THRESHOLD}},this.quiz.variables.timer.stop(),this.container=p.getContainer(),this.quiz.app.layout.main.append(this.container),this.timePassed=0,this.timeLeft=this.settings.TIME_LIMIT,this.timerInterval=null,this.remainingPathColor=this.COLOR_CODES.info.color,this.setContent(),this.timerInterval=setInterval((()=>{this.timePassed+=1,this.timeLeft=this.settings.TIME_LIMIT-this.timePassed,this.container.querySelector("#base-timer-label").innerHTML=p.formatTime(this.timeLeft),this.setCircleDasharray(),this.setRemainingPathColor(this.timeLeft),0===this.timeLeft&&this.onTimesUp()}),1e3))}static getContainer(){return function(t,e,s){const a=document.createElement(t);return e&&(a.className=e),s&&a.append(s),a}("div","timer")}setContent(){this.container.innerHTML=`\n    <div class="base-timer">\n      <svg class="base-timer__svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">\n        <g class="base-timer__circle">\n          <circle class="base-timer__path-elapsed" cx="50" cy="50" r="45"></circle>\n          <path\n            id="base-timer-path-remaining"\n            stroke-dasharray="283"\n            class="base-timer__path-remaining ${this.remainingPathColor}"\n            d="\n              M 50, 50\n              m -45, 0\n              a 45,45 0 1,0 90,0\n              a 45,45 0 1,0 -90,0\n            "\n          ></path>\n        </g>\n      </svg>\n      <span id="base-timer-label" class="base-timer__label">${p.formatTime(this.timeLeft)}</span>\n    </div>`}onTimesUp(){this.stop(),this.quiz.app.layout.body.classList.contains("question")&&this.quiz.processAnswer()}verifySettings(){this.quiz.settings.data.timeLimitedGame?this.init():this.destroy()}stop(){clearInterval(this.timerInterval)}destroy(){this.stop(),this.container&&this.container.remove()}static formatTime(t){let e=t%60;return e<10&&(e=`0${e}`),`${Math.floor(t/60)}:${e}`}setRemainingPathColor(t){const e=(t,e)=>{const s=this.container.querySelector("#base-timer-path-remaining");s.classList.remove(t),s.classList.add(e)},{alert:s,warning:a,info:i}=this.COLOR_CODES;t<=s.threshold?e(a.color,s.color):t<=a.threshold&&e(i.color,a.color)}calculateTimeFraction(){const t=this.timeLeft/this.settings.TIME_LIMIT;return t-1/this.settings.TIME_LIMIT*(1-t)}setCircleDasharray(){const t=`${(this.calculateTimeFraction()*this.settings.FULL_DASH_ARRAY).toFixed(0)} 283`;this.container.querySelector("#base-timer-path-remaining").setAttribute("stroke-dasharray",t)}}class v{static QUIZ_TYPES=[{id:"artist",title:"Artist Quiz"},{id:"pictures",title:"Pictures Quiz"}];static QUIZ_CATEGORIES={en:["Portrait","Landscape","Still Life","Pop-Art","Сubism","Avant-garde","Realism","Interior","Kitsch","Minimalism","Surrealism","Renaissance"],ru:["Портрет","Пейзаж","Натюрморт","Поп-арт","Кубизм","Авангард","Реализм","Интерьер","Китч","Минимализм","Сюрреализм","Ренессанс"]};static SETTINGS={questionsPerRound:a?2:10,numberOfRounds:a?6:12,numberOfAnswerOptions:4,delayAfterAnswer:500,initRandomSort:!1,dbPath:"https://raw.githubusercontent.com/alexpataman/art-quiz-data/main"};constructor(t){this.app=t,this.settings=this.app.settings,this.variables={gameType:null,currentRoundId:null,currentQuestionId:null,currentQuestion:null,currentAnswerOptions:null,timer:new p(this)}}async init(){await this.fetchDb(),this.prepareGameData(),this.showHomePage(),this.setHandlers(),this.prepareSounds()}showHomePage(){const t=document.createElement("section");t.className="game-options",v.QUIZ_TYPES.forEach((e=>{const s=document.createElement("div"),a=document.createElement("a");a.href="#",a.dataset.id=e.id,a.className=e.id,a.textContent=c.Z.t(e.title),a.addEventListener("click",(t=>this.startGame(t)),{once:!0}),s.append(a),t.append(s)})),this.app.layout.setPageContent(t,"home")}showRoundStatisticsPage(t){this.app.layout.setPageContent(this.getRoundStatisticsPageContent(t),"round-statistics"),this.app.layout.addBackLink(this.showRoundSelectorPage,this)}showRoundSelectorPage(){this.loadGameData(),this.app.layout.setPageContent(this.getRoundSelectorPageContent(),"round-selector"),this.app.layout.addBackLink(this.showHomePage,this)}async startQuestion(t,e=0){this.variables.currentQuestionId=e,this.variables.currentQuestion=this.getQuestion(t,e),this.variables.currentAnswerOptions=v.shuffleOptions(this.variables.currentQuestion.data,this.getWrongOptions()),await this.app.layout.setPageContent(this.getQuestionPageContent(),"question"),this.app.layout.addBackLink(this.showRoundSelectorPage,this),this.preloadNextQuestionImages(),this.variables.timer.init()}async fetchDb(){const t=await fetch(`${v.SETTINGS.dbPath}/data.json`);this.db=await t.json()}getQuestion(t,e){return{data:this.db[this.settings.data.language][this.data.quizzes[this.variables.gameType].rounds[t].questions[e].data.index]}}static shuffleOptions(t,e){return e.concat(t).sort((()=>.5-Math.random()))}getWrongOptions(){return this.db[this.settings.data.language].filter((t=>!(JSON.stringify(t)===JSON.stringify(this.variables.currentQuestion.data)))).reduce(((t,e)=>{var s;return!(this.variables.currentQuestion.data.author.toLocaleLowerCase()===e.author.toLocaleLowerCase())&&(s=e,t.every((t=>s.author.toLocaleLowerCase()!==t.author.toLocaleLowerCase())))&&t.push(e),t}),[]).sort((()=>.5-Math.random())).slice(0,v.SETTINGS.numberOfAnswerOptions-1)}getQuestionFinalModalContent(){const t=this.getRoundStatistics(this.variables.currentRoundId),e=document.createElement("div");e.className="results",t.correct===t.total?e.innerHTML=`      \n      <div class="great">\n        <img src="./assets/svg/round_stars.svg">\n        <h3>${c.Z.t("Grand result")}</h3>        \n      </div>`:t.correct>0?e.innerHTML=`      \n      <div class="normal">\n        <img src="./assets/svg/round_cup.svg">\n        <h3>${c.Z.t("Congratulations!")}</h3>        \n      </div>`:e.innerHTML=`      \n      <div class="fail">\n        <img src="./assets/svg/round_broken_cup.svg">\n        <h3>${c.Z.t("Good luck next time!")}</h3>        \n      </div>`,e.innerHTML+=`\n      <div class="score">\n        ${t.correct}/${t.total}\n      </div>\n      <div class="nav">\n        <button class="button-white home-page">${c.Z.t("Home")}</button>      \n        <button class="button-pink next-quiz">${c.Z.t("Next Quiz")}</button>      \n      </div>\n    `;e.querySelector(".home-page").addEventListener("click",(()=>{this.app.layout.modal.close(),this.showHomePage()}),{once:!0});return e.querySelector(".next-quiz").addEventListener("click",(()=>{this.app.layout.modal.close(),this.showRoundSelectorPage()}),{once:!0}),e}getQuestionAnswerModalContent(t,e,s=!1){const a=document.createElement("div");a.innerHTML=`\n      <figure class="${e?"correct":"wrong"}">\n        <img \n        src="${v.getQuestionImageUrl(t.data.imageNum)}" \n        title="${t.data.name}" \n        alt="${t.data.name}">        \n      </figure>\n      <div class="details">\n        <h3>${t.data.name}</h3>\n        <i>\n          ${t.data.author}, \n          ${t.data.year}\n        </i> \n        <div class="download"><a href="#">${c.Z.t("Download")}</a></div>\n      </div>            \n    `,a.querySelector(".download").addEventListener("click",(()=>g(v.getQuestionImageFullUrl(t.data.imageNum),`${t.data.author}-${t.data.name}[${t.data.year}]`)),{once:!0});const i=document.createElement("button");return s?(i.className="button-pink next-question",i.textContent=c.Z.t("Next"),i.addEventListener("click",(()=>{this.app.layout.modal.close(),this.nextQuestion()}),{once:!0})):(i.className="button-pink",i.textContent=c.Z.t("Close"),i.addEventListener("click",(()=>{this.app.layout.modal.close()}),{once:!0})),a.append(i),a}getRoundStatisticsPageContent(t){const e=document.createElement("section");e.innerHTML=`<h1>${v.QUIZ_CATEGORIES[this.settings.data.language][t]} / ${c.Z.t("Score")}</h1>`;const s=document.createElement("div");return s.className="items",this.data.quizzes[this.variables.gameType].rounds[t].questions.forEach(((e,a)=>{const i=document.createElement("div");i.className=e.status?"correct":"wrong",i.dataset.id=a,i.innerHTML=`\n        <img src="${v.getQuestionImageUrl(e.data.imageNum)}" alr="">        \n      `,i.addEventListener("click",(()=>{this.app.layout.modal.open(this.getQuestionAnswerModalContent(this.getQuestion(t,a),e.status))}),{once:!0}),s.append(i)})),e.append(s),e}getRoundSelectorPageContent(){const t=document.createElement("section");for(let e=0;e<v.SETTINGS.numberOfRounds;e+=1){const s=this.getRoundStatistics(e),a=document.createElement("div");a.dataset.roundId=e,s.correct===s.total?a.className="success":s.correct+s.wrong>0?a.className="fail":a.className="neutral",a.innerHTML=`\n        <h3>\n          <span>${v.QUIZ_CATEGORIES[this.settings.data.language][e]}</span>\n          <span class="score" data-round-id="${e}">\n          ${s.correct}/${s.total}\n          </span>\n        </h3>\n        <div class="category-image">\n          <img src="${this.getRoundImageUrl(e)}" alr="">        \n          <div class="hover">\n            <a href="#" class="statistics" data-round-id="${e}">${c.Z.t("Score")}</a>\n            <a href="#" class="play-again" data-round-id="${e}">${c.Z.t("Play Again")}</a>\n          </div>\n        </div>        \n      `;a.querySelectorAll(".statistics, .score").forEach((t=>t.addEventListener("click",(t=>{this.showRoundStatisticsPage(t.currentTarget.dataset.roundId)}),{once:!0}))),a.querySelector(".play-again").addEventListener("click",(t=>this.startRound(t.currentTarget.dataset.roundId)),{once:!0}),s.correct+s.wrong?a.querySelector(".category-image").addEventListener("click",(t=>{this.app.layout.main.querySelectorAll(".touched").forEach((t=>{t.classList.remove("touched")})),t.currentTarget.classList.add("touched")}),{once:!0}):a.addEventListener("click",(t=>{this.startRound(t.currentTarget.dataset.roundId)}),{once:!0}),t.append(a)}return t}resetRoundProgress(t){for(let e=0;e<v.SETTINGS.questionsPerRound;e+=1)this.data.quizzes[this.variables.gameType].rounds[t].questions[e].status=null}getRoundStatistics(t){return this.data.quizzes[this.variables.gameType].rounds[t].questions.reduce(((t,e)=>(t.total+=1,!0===e.status?t.correct+=1:!1===e.status&&(t.wrong+=1),t)),{correct:0,wrong:0,total:0})}getRoundProgressBarContent(){const t=document.createElement("ul");return this.data.quizzes[this.variables.gameType].rounds[this.variables.currentRoundId].questions.forEach((e=>{const s=document.createElement("li");!0===e.status?s.className="correct":!1===e.status?s.className="wrong":s.className="new",t.append(s)})),t}getQuestionPageContent(){const t=document.createElement("section");if(t.append(this.getRoundProgressBarContent()),"artist"===this.variables.gameType)t.append(this.getQuestionArtistPageContent());else t.append(this.getQuestionPicturesPageContent());return t}getQuestionArtistPageContent(){const t=document.createElement("div"),e=document.createElement("img"),s=document.createElement("div");return s.className="answer-options artists",e.src=v.getQuestionImageUrl(this.variables.currentQuestion.data.imageNum),this.variables.currentAnswerOptions.forEach(((t,e)=>{const a=document.createElement("button");a.dataset.id=e,a.textContent=t.author,a.addEventListener("click",(t=>this.processAnswer(t.currentTarget.dataset.id)),{once:!0}),s.append(a)})),t.append(e),t.append(s),t}getQuestionPicturesPageContent(){this.app.layout.startLoader();const t=document.createElement("div"),e=document.createElement("h2"),s=c.Z.t("Which picture was painted by {{author}}?");e.textContent=s.replace("{{author}}",this.variables.currentQuestion.data.author);const a=document.createElement("div");return a.className="answer-options pictures",this.variables.currentAnswerOptions.forEach(((t,e)=>{const s=v.getQuestionImageUrl(t.imageNum);this.app.layout.addLoadingItem(s),v.preloadImage(s,(()=>this.app.layout.removeLoadingItem(s)));const i=document.createElement("img");i.dataset.id=e,i.alt=t.name,i.title=t.name,i.src=v.getQuestionImageUrl(t.imageNum),i.addEventListener("click",(t=>this.processAnswer(t.currentTarget.dataset.id)),{once:!0}),a.append(i)})),t.append(e),t.append(a),t}processAnswer(t){let e;this.variables.timer.stop(),e=t>=0&&this.isCorrectAnswer(t),e?this.playEffect("answerCorrect"):this.playEffect("answerWrong"),this.highlightAnswers(t),this.setUserAnswer(e),setTimeout((()=>{this.app.layout.modal.open(this.getQuestionAnswerModalContent(this.variables.currentQuestion,e,!0))}),v.SETTINGS.delayAfterAnswer)}highlightAnswers(t){this.app.layout.main.querySelectorAll(".answer-options > *").forEach(((e,s)=>{s===+t&&(e.textContent===this.variables.currentQuestion.data.author||e.title===this.variables.currentQuestion.data.name?e.classList.add("correct"):e.classList.add("wrong"))}))}nextQuestion(){this.variables.timer.destroy(),this.variables.currentQuestionId<v.SETTINGS.questionsPerRound-1?(this.variables.currentQuestionId+=1,this.startQuestion(this.variables.currentRoundId,this.variables.currentQuestionId)):(this.saveGameData(),setTimeout((()=>{this.playEffect("roundEnd"),this.app.layout.modal.open(this.getQuestionFinalModalContent())}),v.SETTINGS.delayAfterAnswer))}nextRound(){this.variables.currentRoundId+=1,this.variables.currentQuestionId=0,this.startQuestion(this.variables.currentRoundId,this.variables.currentQuestionId)}setUserAnswer(t){this.data.quizzes[this.variables.gameType].rounds[this.variables.currentRoundId].questions[this.variables.currentQuestionId].status=t}isCorrectAnswer(t){const e=this.variables.currentAnswerOptions[t];return JSON.stringify(e)===JSON.stringify(this.variables.currentQuestion.data)}static getQuestionImageUrl(t){return`${v.SETTINGS.dbPath}/images/small/${t}.jpg`}static getQuestionImageFullUrl(t){return`${v.SETTINGS.dbPath}/images/full/${t}full.jpg`}getRoundImageUrl(t){return`${v.SETTINGS.dbPath}/images/small/${this.data.quizzes[this.variables.gameType].rounds[t].imageNum}.jpg`}setupGameData(){this.data={settings:{},quizzes:{}},this.setupQuestions(),this.saveGameData()}setupQuestions(){let t=[...this.db[this.settings.data.language]];v.SETTINGS.initRandomSort&&(t=t.sort((()=>.5-Math.random())));let e=0;v.QUIZ_TYPES.forEach((s=>{this.data.quizzes[s.id]={rounds:[]};for(let a=0;a<v.SETTINGS.numberOfRounds;a+=1){const a={questions:[],imageNum:null};for(let s=0;s<v.SETTINGS.questionsPerRound;s+=1)a.questions.push({data:{index:e,imageNum:t[e].imageNum},status:null}),e+=1;a.imageNum=a.questions[Math.floor(Math.random()*v.SETTINGS.questionsPerRound)].data.imageNum,this.data.quizzes[s.id].rounds.push(a)}}))}preloadNecessaryImages(){v.QUIZ_TYPES.forEach((t=>{this.data.quizzes[t.id].rounds.forEach((t=>{v.preloadImage(v.getQuestionImageUrl(t.imageNum)),v.preloadImage(v.getQuestionImageUrl(t.questions[0].data.imageNum))}))}))}preloadNextQuestionImages(){if(this.variables.currentQuestionId<v.SETTINGS.questionsPerRound-1){const t=this.getQuestion(this.variables.currentRoundId,this.variables.currentQuestionId+1);v.preloadImage(v.getQuestionImageUrl(t.data.imageNum))}}static preloadImage(t,e){const s=new Image;s.src=t,s.onload=e}prepareGameData(){this.loadGameData(),this.data||this.setupGameData(),this.preloadNecessaryImages()}loadGameData(){this.data=this.app.storage.exists("gameData")?this.app.storage.get("gameData"):null}saveGameData(){this.app.storage.set("gameData",this.data)}startGame(t){this.variables.gameType=t.target.dataset.id,this.showRoundSelectorPage(),this.playMusic()}prepareSounds(){this.app.sounds.setVolume("music",this.settings.data.musicVolumeLevel),this.app.sounds.setVolume("effects",this.settings.data.musicVolumeLevel)}playMusic(){this.settings.data.enableMusic&&this.app.sounds.playMusic()}playEffect(t){this.settings.data.enableSoundEffects&&this.app.sounds.playEffect(t)}startRound(t){this.variables.currentRoundId=t,this.resetRoundProgress(this.variables.currentRoundId),this.startQuestion(this.variables.currentRoundId)}setHandlers(){this.app.layout.header.querySelector(".logo").addEventListener("click",(()=>this.showHomePage())),document.addEventListener("changeLanguage",(()=>this.showHomePage()))}}const f=new class{constructor(){this.storage=new n,this.layout=new r,this.sounds=new l,this.translations=new h,this.settings=new m(this),this.quiz=new v(this)}run(){this.settings.init(),this.quiz.init()}};s(142);f.run()}},s={};function a(t){var i=s[t];if(void 0!==i)return i.exports;var n=s[t]={exports:{}};return e[t](n,n.exports,a),n.exports}a.m=e,t=[],a.O=(e,s,i,n)=>{if(!s){var o=1/0;for(u=0;u<t.length;u++){for(var[s,i,n]=t[u],r=!0,l=0;l<s.length;l++)(!1&n||o>=n)&&Object.keys(a.O).every((t=>a.O[t](s[l])))?s.splice(l--,1):(r=!1,n<o&&(o=n));if(r){t.splice(u--,1);var c=i();void 0!==c&&(e=c)}}return e}n=n||0;for(var u=t.length;u>0&&t[u-1][2]>n;u--)t[u]=t[u-1];t[u]=[s,i,n]},a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},a.d=(t,e)=>{for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={179:0};a.O.j=e=>0===t[e];var e=(e,s)=>{var i,n,[o,r,l]=s,c=0;if(o.some((e=>0!==t[e]))){for(i in r)a.o(r,i)&&(a.m[i]=r[i]);if(l)var u=l(a)}for(e&&e(s);c<o.length;c++)n=o[c],a.o(t,n)&&t[n]&&t[n][0](),t[o[c]]=0;return a.O(u)},s=self.webpackChunk=self.webpackChunk||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var i=a.O(void 0,[439],(()=>a(393)));i=a.O(i)})();